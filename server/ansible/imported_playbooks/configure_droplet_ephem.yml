- hosts: sageEphem
  vars:
    digital_ocean_token: '{{ lookup("env", "DO_API_TOKEN") }}'
    ansible_ssh_private_key_file: '{{ lookup("env", "EPHEM_SSH_KEY_FILE_PRIV") }}'
    ansible_user: root
  tasks:
    - name: Install git on the droplet server
      become: yes
      ansible.builtin.apt:
        name: git
        state: present
      delegate_to: "{{ public_ip }}"

    - name: Clone the GitLab repository
      ansible.builtin.git:
        repo: 'https://github.com/katefike/sage.git'
        dest: '/home/sage/'
      delegate_to: "{{ public_ip }}"